(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     70438,       2014]
NotebookOptionsPosition[     68633,       1954]
NotebookOutlinePosition[     69181,       1975]
CellTagsIndexPosition[     69138,       1972]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"transplus", "=", 
  RowBox[{
   RowBox[{"Transpose", "[", "y_Plus", "]"}], "\[RuleDelayed]", 
   RowBox[{"Distribute", "[", 
    RowBox[{"Transpose", "[", "y", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"transdot", "=", 
  RowBox[{
   RowBox[{"Transpose", "[", "y_Dot", "]"}], "\[RuleDelayed]", 
   RowBox[{"Distribute", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Reverse", "[", "y", "]"}], "]"}], ",", "Dot"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Transpose", "[", 
   RowBox[{"a", "+", "b", "+", "c"}], "]"}], "/.", 
  "transplus"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Transpose", "[", 
   RowBox[{"a", ".", "b", ".", "c"}], "]"}], "/.", "transdot"}]}], "Input",
 CellChangeTimes->{{3.646045482624654*^9, 3.646045512641655*^9}, {
  3.64604558150154*^9, 3.6460455859409847`*^9}, {3.646045642783668*^9, 
  3.6460456482972193`*^9}, {3.646045686986088*^9, 3.6460457090232916`*^9}, {
  3.646045850304418*^9, 3.646045862984686*^9}, {3.646045910307418*^9, 
  3.6460459150028872`*^9}, {3.6460497575911074`*^9, 3.6460497757799263`*^9}, {
  3.6460498146348114`*^9, 3.6460498519995475`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transpose", "[", "y_Plus", "]"}], "\[RuleDelayed]", 
  RowBox[{"Distribute", "[", 
   RowBox[{"Transpose", "[", "y", "]"}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.6460455132937202`*^9, 3.6460455862100115`*^9, 3.6460456487472644`*^9, {
   3.646045687367126*^9, 3.6460457093333225`*^9}, {3.646045858213209*^9, 
   3.6460458633397217`*^9}, 3.646045915320919*^9, 3.646046026948081*^9, {
   3.646049824187767*^9, 3.64604985232358*^9}, 3.6461207435988655`*^9, 
   3.6463830221991596`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transpose", "[", "y_Dot", "]"}], "\[RuleDelayed]", 
  RowBox[{"Distribute", "[", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"Reverse", "[", "y", "]"}], "]"}], ",", "Dot"}], 
   "]"}]}]], "Output",
 CellChangeTimes->{
  3.6460455132937202`*^9, 3.6460455862100115`*^9, 3.6460456487472644`*^9, {
   3.646045687367126*^9, 3.6460457093333225`*^9}, {3.646045858213209*^9, 
   3.6460458633397217`*^9}, 3.646045915320919*^9, 3.646046026948081*^9, {
   3.646049824187767*^9, 3.64604985232358*^9}, 3.6461207435988655`*^9, 
   3.6463830221991596`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transpose", "[", "a", "]"}], "+", 
  RowBox[{"Transpose", "[", "b", "]"}], "+", 
  RowBox[{"Transpose", "[", "c", "]"}]}]], "Output",
 CellChangeTimes->{
  3.6460455132937202`*^9, 3.6460455862100115`*^9, 3.6460456487472644`*^9, {
   3.646045687367126*^9, 3.6460457093333225`*^9}, {3.646045858213209*^9, 
   3.6460458633397217`*^9}, 3.646045915320919*^9, 3.646046026948081*^9, {
   3.646049824187767*^9, 3.64604985232358*^9}, 3.6461207435988655`*^9, 
   3.6463830221991596`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transpose", "[", "c", "]"}], ".", 
  RowBox[{"Transpose", "[", "b", "]"}], ".", 
  RowBox[{"Transpose", "[", "a", "]"}]}]], "Output",
 CellChangeTimes->{
  3.6460455132937202`*^9, 3.6460455862100115`*^9, 3.6460456487472644`*^9, {
   3.646045687367126*^9, 3.6460457093333225`*^9}, {3.646045858213209*^9, 
   3.6460458633397217`*^9}, 3.646045915320919*^9, 3.646046026948081*^9, {
   3.646049824187767*^9, 3.64604985232358*^9}, 3.6461207435988655`*^9, 
   3.6463830221991596`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"x", "[", "1", "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"A", "[", "0", "]"}], ".", 
    RowBox[{"x", "[", "0", "]"}]}], "+", 
   RowBox[{
    RowBox[{"B", "[", "0", "]"}], ".", 
    RowBox[{"u", "[", "0", "]"}]}], "+", 
   RowBox[{"a", "[", "0", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", "[", "2", "]"}], "=", 
  RowBox[{"Map", "[", 
   RowBox[{"Distribute", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"A", "[", "1", "]"}], ".", 
      RowBox[{"x", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"B", "[", "1", "]"}], ".", 
      RowBox[{"u", "[", "1", "]"}]}], "+", 
     RowBox[{"a", "[", "1", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"J", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"x", "[", "0", "]"}], "\[Transpose]"}], ".", 
    RowBox[{"Q", "[", "0", "]"}], ".", 
    RowBox[{"x", "[", "0", "]"}]}], "+", 
   RowBox[{
    RowBox[{"Distribute", "[", 
     RowBox[{
      RowBox[{"x", "[", "1", "]"}], "\[Transpose]"}], "]"}], ".", 
    RowBox[{"Q", "[", "1", "]"}], ".", 
    RowBox[{"x", "[", "1", "]"}]}], "+", 
   RowBox[{
    RowBox[{"Distribute", "[", 
     RowBox[{
      RowBox[{"x", "[", "2", "]"}], "\[Transpose]"}], "]"}], ".", 
    RowBox[{"Q", "[", "2", "]"}], ".", 
    RowBox[{"x", "[", "2", "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.646039643715054*^9, 3.646039667895054*^9}, {
   3.646039717788054*^9, 3.646039941240054*^9}, {3.646039982063054*^9, 
   3.646040057875054*^9}, {3.646040317318175*^9, 3.6460403254859915`*^9}, {
   3.6460409296564026`*^9, 3.646040940905527*^9}, {3.646041080207456*^9, 
   3.646041098088244*^9}, {3.6460416167751074`*^9, 3.6460416448799176`*^9}, {
   3.646045963153702*^9, 3.6460460033867245`*^9}, {3.6460495182151723`*^9, 
   3.646049563672718*^9}, 3.6460496053248825`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", "[", "0", "]"}], "+", 
  RowBox[{
   RowBox[{"A", "[", "0", "]"}], ".", 
   RowBox[{"x", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"B", "[", "0", "]"}], ".", 
   RowBox[{"u", "[", "0", "]"}]}]}]], "Output",
 CellChangeTimes->{3.6461207436578655`*^9, 3.646383022261567*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", "[", "1", "]"}], "+", 
  RowBox[{
   RowBox[{"A", "[", "1", "]"}], ".", 
   RowBox[{"a", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"B", "[", "1", "]"}], ".", 
   RowBox[{"u", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"A", "[", "1", "]"}], ".", 
   RowBox[{"A", "[", "0", "]"}], ".", 
   RowBox[{"x", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"A", "[", "1", "]"}], ".", 
   RowBox[{"B", "[", "0", "]"}], ".", 
   RowBox[{"u", "[", "0", "]"}]}]}]], "Output",
 CellChangeTimes->{3.6461207436578655`*^9, 3.646383022261567*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"a", "[", "0", "]"}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"A", "[", "0", "]"}], ".", 
       RowBox[{"x", "[", "0", "]"}]}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"B", "[", "0", "]"}], ".", 
       RowBox[{"u", "[", "0", "]"}]}], "]"}]}], ")"}], ".", 
   RowBox[{"Q", "[", "1", "]"}], ".", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "+", 
     RowBox[{
      RowBox[{"A", "[", "0", "]"}], ".", 
      RowBox[{"x", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"B", "[", "0", "]"}], ".", 
      RowBox[{"u", "[", "0", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"a", "[", "1", "]"}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"A", "[", "1", "]"}], ".", 
       RowBox[{"a", "[", "0", "]"}]}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"B", "[", "1", "]"}], ".", 
       RowBox[{"u", "[", "1", "]"}]}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"A", "[", "1", "]"}], ".", 
       RowBox[{"A", "[", "0", "]"}], ".", 
       RowBox[{"x", "[", "0", "]"}]}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"A", "[", "1", "]"}], ".", 
       RowBox[{"B", "[", "0", "]"}], ".", 
       RowBox[{"u", "[", "0", "]"}]}], "]"}]}], ")"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], "+", 
     RowBox[{
      RowBox[{"A", "[", "1", "]"}], ".", 
      RowBox[{"a", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"B", "[", "1", "]"}], ".", 
      RowBox[{"u", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"A", "[", "1", "]"}], ".", 
      RowBox[{"A", "[", "0", "]"}], ".", 
      RowBox[{"x", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"A", "[", "1", "]"}], ".", 
      RowBox[{"B", "[", "0", "]"}], ".", 
      RowBox[{"u", "[", "0", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"x", "[", "0", "]"}], "]"}], ".", 
   RowBox[{"Q", "[", "0", "]"}], ".", 
   RowBox[{"x", "[", "0", "]"}]}]}]], "Output",
 CellChangeTimes->{3.6461207436578655`*^9, 3.646383022261567*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"J", "=", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "i", "]"}], "\[Transpose]"}], ".", 
      RowBox[{"Q", "[", "i", "]"}], ".", 
      RowBox[{"x", "[", "i", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "2"}], "}"}]}], "]"}], "+", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"x", "[", "i", "]"}], "\[Transpose]"}], ".", 
       RowBox[{"S", "[", "i", "]"}], ".", 
       RowBox[{"u", "[", "i", "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"u", "[", "i", "]"}], "\[Transpose]"}], ".", 
       RowBox[{
        RowBox[{"S", "[", "i", "]"}], "\[Transpose]"}], ".", 
       RowBox[{"x", "[", "i", "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"u", "[", "i", "]"}], "\[Transpose]"}], ".", 
       RowBox[{"R", "[", "i", "]"}], ".", 
       RowBox[{"u", "[", "i", "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "1"}], "}"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"J", "=", 
  RowBox[{"J", "/.", 
   RowBox[{"x_Dot", "\[RuleDelayed]", 
    RowBox[{"Distribute", "[", "x", "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"J", "=", 
  RowBox[{"J", "/.", "transplus"}]}], "\[IndentingNewLine]", 
 RowBox[{"J", "=", 
  RowBox[{"J", "/.", 
   RowBox[{"x_Dot", "\[RuleDelayed]", 
    RowBox[{"Distribute", "[", "x", "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"J", "=", 
  RowBox[{"J", "/.", "transdot"}]}]}], "Input",
 CellChangeTimes->{{3.6460496086702175`*^9, 3.646049677534103*^9}, {
  3.646049875486896*^9, 3.6460498769090385`*^9}, {3.6460501047188168`*^9, 
  3.646050190596404*^9}, {3.6460510087922153`*^9, 3.6460510092392597`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "+", 
     RowBox[{
      RowBox[{"A", "[", "0", "]"}], ".", 
      RowBox[{"x", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"B", "[", "0", "]"}], ".", 
      RowBox[{"u", "[", "0", "]"}]}]}], "]"}], ".", 
   RowBox[{"Q", "[", "1", "]"}], ".", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "+", 
     RowBox[{
      RowBox[{"A", "[", "0", "]"}], ".", 
      RowBox[{"x", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"B", "[", "0", "]"}], ".", 
      RowBox[{"u", "[", "0", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "+", 
     RowBox[{
      RowBox[{"A", "[", "0", "]"}], ".", 
      RowBox[{"x", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"B", "[", "0", "]"}], ".", 
      RowBox[{"u", "[", "0", "]"}]}]}], "]"}], ".", 
   RowBox[{"S", "[", "1", "]"}], ".", 
   RowBox[{"u", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], "+", 
     RowBox[{
      RowBox[{"A", "[", "1", "]"}], ".", 
      RowBox[{"a", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"B", "[", "1", "]"}], ".", 
      RowBox[{"u", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"A", "[", "1", "]"}], ".", 
      RowBox[{"A", "[", "0", "]"}], ".", 
      RowBox[{"x", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"A", "[", "1", "]"}], ".", 
      RowBox[{"B", "[", "0", "]"}], ".", 
      RowBox[{"u", "[", "0", "]"}]}]}], "]"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], "+", 
     RowBox[{
      RowBox[{"A", "[", "1", "]"}], ".", 
      RowBox[{"a", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"B", "[", "1", "]"}], ".", 
      RowBox[{"u", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"A", "[", "1", "]"}], ".", 
      RowBox[{"A", "[", "0", "]"}], ".", 
      RowBox[{"x", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"A", "[", "1", "]"}], ".", 
      RowBox[{"B", "[", "0", "]"}], ".", 
      RowBox[{"u", "[", "0", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"u", "[", "0", "]"}], "]"}], ".", 
   RowBox[{"R", "[", "0", "]"}], ".", 
   RowBox[{"u", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"u", "[", "0", "]"}], "]"}], ".", 
   RowBox[{"Transpose", "[", 
    RowBox[{"S", "[", "0", "]"}], "]"}], ".", 
   RowBox[{"x", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"u", "[", "1", "]"}], "]"}], ".", 
   RowBox[{"R", "[", "1", "]"}], ".", 
   RowBox[{"u", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"u", "[", "1", "]"}], "]"}], ".", 
   RowBox[{"Transpose", "[", 
    RowBox[{"S", "[", "1", "]"}], "]"}], ".", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "+", 
     RowBox[{
      RowBox[{"A", "[", "0", "]"}], ".", 
      RowBox[{"x", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"B", "[", "0", "]"}], ".", 
      RowBox[{"u", "[", "0", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"x", "[", "0", "]"}], "]"}], ".", 
   RowBox[{"Q", "[", "0", "]"}], ".", 
   RowBox[{"x", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"x", "[", "0", "]"}], "]"}], ".", 
   RowBox[{"S", "[", "0", "]"}], ".", 
   RowBox[{"u", "[", "0", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.646039648859054*^9, 3.646039668910054*^9}, {
   3.6460398293820543`*^9, 3.646039884189054*^9}, {3.646039921593054*^9, 
   3.6460399415400543`*^9}, {3.646039982410054*^9, 3.646040026977054*^9}, 
   3.646040068740054*^9, 3.6460403264020834`*^9, 3.6460409414915857`*^9, 
   3.646041098458281*^9, 3.64604164520395*^9, 3.646043692766686*^9, 
   3.6460437814595547`*^9, 3.6460459435137377`*^9, {3.6460459823136177`*^9, 
   3.6460460045588417`*^9}, 3.64604967790714*^9, 3.6460498776241097`*^9, 
   3.6460501910514493`*^9, 3.6460502685401974`*^9, 3.6460505637467155`*^9, {
   3.646051003365673*^9, 3.646051013203656*^9}, 3.646120743682865*^9, 
   3.646383022292771*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "+", 
     RowBox[{
      RowBox[{"A", "[", "0", "]"}], ".", 
      RowBox[{"x", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"B", "[", "0", "]"}], ".", 
      RowBox[{"u", "[", "0", "]"}]}]}], "]"}], ".", 
   RowBox[{"Q", "[", "1", "]"}], ".", 
   RowBox[{"a", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "+", 
     RowBox[{
      RowBox[{"A", "[", "0", "]"}], ".", 
      RowBox[{"x", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"B", "[", "0", "]"}], ".", 
      RowBox[{"u", "[", "0", "]"}]}]}], "]"}], ".", 
   RowBox[{"S", "[", "1", "]"}], ".", 
   RowBox[{"u", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], "+", 
     RowBox[{
      RowBox[{"A", "[", "1", "]"}], ".", 
      RowBox[{"a", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"B", "[", "1", "]"}], ".", 
      RowBox[{"u", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"A", "[", "1", "]"}], ".", 
      RowBox[{"A", "[", "0", "]"}], ".", 
      RowBox[{"x", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"A", "[", "1", "]"}], ".", 
      RowBox[{"B", "[", "0", "]"}], ".", 
      RowBox[{"u", "[", "0", "]"}]}]}], "]"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"a", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"u", "[", "0", "]"}], "]"}], ".", 
   RowBox[{"R", "[", "0", "]"}], ".", 
   RowBox[{"u", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"u", "[", "0", "]"}], "]"}], ".", 
   RowBox[{"Transpose", "[", 
    RowBox[{"S", "[", "0", "]"}], "]"}], ".", 
   RowBox[{"x", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"u", "[", "1", "]"}], "]"}], ".", 
   RowBox[{"R", "[", "1", "]"}], ".", 
   RowBox[{"u", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"u", "[", "1", "]"}], "]"}], ".", 
   RowBox[{"Transpose", "[", 
    RowBox[{"S", "[", "1", "]"}], "]"}], ".", 
   RowBox[{"a", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"x", "[", "0", "]"}], "]"}], ".", 
   RowBox[{"Q", "[", "0", "]"}], ".", 
   RowBox[{"x", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"x", "[", "0", "]"}], "]"}], ".", 
   RowBox[{"S", "[", "0", "]"}], ".", 
   RowBox[{"u", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "+", 
     RowBox[{
      RowBox[{"A", "[", "0", "]"}], ".", 
      RowBox[{"x", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"B", "[", "0", "]"}], ".", 
      RowBox[{"u", "[", "0", "]"}]}]}], "]"}], ".", 
   RowBox[{"Q", "[", "1", "]"}], ".", 
   RowBox[{"A", "[", "0", "]"}], ".", 
   RowBox[{"x", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "+", 
     RowBox[{
      RowBox[{"A", "[", "0", "]"}], ".", 
      RowBox[{"x", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"B", "[", "0", "]"}], ".", 
      RowBox[{"u", "[", "0", "]"}]}]}], "]"}], ".", 
   RowBox[{"Q", "[", "1", "]"}], ".", 
   RowBox[{"B", "[", "0", "]"}], ".", 
   RowBox[{"u", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], "+", 
     RowBox[{
      RowBox[{"A", "[", "1", "]"}], ".", 
      RowBox[{"a", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"B", "[", "1", "]"}], ".", 
      RowBox[{"u", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"A", "[", "1", "]"}], ".", 
      RowBox[{"A", "[", "0", "]"}], ".", 
      RowBox[{"x", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"A", "[", "1", "]"}], ".", 
      RowBox[{"B", "[", "0", "]"}], ".", 
      RowBox[{"u", "[", "0", "]"}]}]}], "]"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"A", "[", "1", "]"}], ".", 
   RowBox[{"a", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], "+", 
     RowBox[{
      RowBox[{"A", "[", "1", "]"}], ".", 
      RowBox[{"a", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"B", "[", "1", "]"}], ".", 
      RowBox[{"u", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"A", "[", "1", "]"}], ".", 
      RowBox[{"A", "[", "0", "]"}], ".", 
      RowBox[{"x", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"A", "[", "1", "]"}], ".", 
      RowBox[{"B", "[", "0", "]"}], ".", 
      RowBox[{"u", "[", "0", "]"}]}]}], "]"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"B", "[", "1", "]"}], ".", 
   RowBox[{"u", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"u", "[", "1", "]"}], "]"}], ".", 
   RowBox[{"Transpose", "[", 
    RowBox[{"S", "[", "1", "]"}], "]"}], ".", 
   RowBox[{"A", "[", "0", "]"}], ".", 
   RowBox[{"x", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"u", "[", "1", "]"}], "]"}], ".", 
   RowBox[{"Transpose", "[", 
    RowBox[{"S", "[", "1", "]"}], "]"}], ".", 
   RowBox[{"B", "[", "0", "]"}], ".", 
   RowBox[{"u", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], "+", 
     RowBox[{
      RowBox[{"A", "[", "1", "]"}], ".", 
      RowBox[{"a", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"B", "[", "1", "]"}], ".", 
      RowBox[{"u", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"A", "[", "1", "]"}], ".", 
      RowBox[{"A", "[", "0", "]"}], ".", 
      RowBox[{"x", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"A", "[", "1", "]"}], ".", 
      RowBox[{"B", "[", "0", "]"}], ".", 
      RowBox[{"u", "[", "0", "]"}]}]}], "]"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"A", "[", "1", "]"}], ".", 
   RowBox[{"A", "[", "0", "]"}], ".", 
   RowBox[{"x", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], "+", 
     RowBox[{
      RowBox[{"A", "[", "1", "]"}], ".", 
      RowBox[{"a", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"B", "[", "1", "]"}], ".", 
      RowBox[{"u", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"A", "[", "1", "]"}], ".", 
      RowBox[{"A", "[", "0", "]"}], ".", 
      RowBox[{"x", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"A", "[", "1", "]"}], ".", 
      RowBox[{"B", "[", "0", "]"}], ".", 
      RowBox[{"u", "[", "0", "]"}]}]}], "]"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"A", "[", "1", "]"}], ".", 
   RowBox[{"B", "[", "0", "]"}], ".", 
   RowBox[{"u", "[", "0", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.646039648859054*^9, 3.646039668910054*^9}, {
   3.6460398293820543`*^9, 3.646039884189054*^9}, {3.646039921593054*^9, 
   3.6460399415400543`*^9}, {3.646039982410054*^9, 3.646040026977054*^9}, 
   3.646040068740054*^9, 3.6460403264020834`*^9, 3.6460409414915857`*^9, 
   3.646041098458281*^9, 3.64604164520395*^9, 3.646043692766686*^9, 
   3.6460437814595547`*^9, 3.6460459435137377`*^9, {3.6460459823136177`*^9, 
   3.6460460045588417`*^9}, 3.64604967790714*^9, 3.6460498776241097`*^9, 
   3.6460501910514493`*^9, 3.6460502685401974`*^9, 3.6460505637467155`*^9, {
   3.646051003365673*^9, 3.646051013203656*^9}, 3.646120743682865*^9, 
   3.646383022292771*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"a", "[", "0", "]"}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"A", "[", "0", "]"}], ".", 
       RowBox[{"x", "[", "0", "]"}]}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"B", "[", "0", "]"}], ".", 
       RowBox[{"u", "[", "0", "]"}]}], "]"}]}], ")"}], ".", 
   RowBox[{"Q", "[", "1", "]"}], ".", 
   RowBox[{"a", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"a", "[", "0", "]"}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"A", "[", "0", "]"}], ".", 
       RowBox[{"x", "[", "0", "]"}]}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"B", "[", "0", "]"}], ".", 
       RowBox[{"u", "[", "0", "]"}]}], "]"}]}], ")"}], ".", 
   RowBox[{"S", "[", "1", "]"}], ".", 
   RowBox[{"u", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"a", "[", "1", "]"}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"A", "[", "1", "]"}], ".", 
       RowBox[{"a", "[", "0", "]"}]}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"B", "[", "1", "]"}], ".", 
       RowBox[{"u", "[", "1", "]"}]}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"A", "[", "1", "]"}], ".", 
       RowBox[{"A", "[", "0", "]"}], ".", 
       RowBox[{"x", "[", "0", "]"}]}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"A", "[", "1", "]"}], ".", 
       RowBox[{"B", "[", "0", "]"}], ".", 
       RowBox[{"u", "[", "0", "]"}]}], "]"}]}], ")"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"a", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"u", "[", "0", "]"}], "]"}], ".", 
   RowBox[{"R", "[", "0", "]"}], ".", 
   RowBox[{"u", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"u", "[", "0", "]"}], "]"}], ".", 
   RowBox[{"Transpose", "[", 
    RowBox[{"S", "[", "0", "]"}], "]"}], ".", 
   RowBox[{"x", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"u", "[", "1", "]"}], "]"}], ".", 
   RowBox[{"R", "[", "1", "]"}], ".", 
   RowBox[{"u", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"u", "[", "1", "]"}], "]"}], ".", 
   RowBox[{"Transpose", "[", 
    RowBox[{"S", "[", "1", "]"}], "]"}], ".", 
   RowBox[{"a", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"x", "[", "0", "]"}], "]"}], ".", 
   RowBox[{"Q", "[", "0", "]"}], ".", 
   RowBox[{"x", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"x", "[", "0", "]"}], "]"}], ".", 
   RowBox[{"S", "[", "0", "]"}], ".", 
   RowBox[{"u", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"a", "[", "0", "]"}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"A", "[", "0", "]"}], ".", 
       RowBox[{"x", "[", "0", "]"}]}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"B", "[", "0", "]"}], ".", 
       RowBox[{"u", "[", "0", "]"}]}], "]"}]}], ")"}], ".", 
   RowBox[{"Q", "[", "1", "]"}], ".", 
   RowBox[{"A", "[", "0", "]"}], ".", 
   RowBox[{"x", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"a", "[", "0", "]"}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"A", "[", "0", "]"}], ".", 
       RowBox[{"x", "[", "0", "]"}]}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"B", "[", "0", "]"}], ".", 
       RowBox[{"u", "[", "0", "]"}]}], "]"}]}], ")"}], ".", 
   RowBox[{"Q", "[", "1", "]"}], ".", 
   RowBox[{"B", "[", "0", "]"}], ".", 
   RowBox[{"u", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"a", "[", "1", "]"}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"A", "[", "1", "]"}], ".", 
       RowBox[{"a", "[", "0", "]"}]}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"B", "[", "1", "]"}], ".", 
       RowBox[{"u", "[", "1", "]"}]}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"A", "[", "1", "]"}], ".", 
       RowBox[{"A", "[", "0", "]"}], ".", 
       RowBox[{"x", "[", "0", "]"}]}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"A", "[", "1", "]"}], ".", 
       RowBox[{"B", "[", "0", "]"}], ".", 
       RowBox[{"u", "[", "0", "]"}]}], "]"}]}], ")"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"A", "[", "1", "]"}], ".", 
   RowBox[{"a", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"a", "[", "1", "]"}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"A", "[", "1", "]"}], ".", 
       RowBox[{"a", "[", "0", "]"}]}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"B", "[", "1", "]"}], ".", 
       RowBox[{"u", "[", "1", "]"}]}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"A", "[", "1", "]"}], ".", 
       RowBox[{"A", "[", "0", "]"}], ".", 
       RowBox[{"x", "[", "0", "]"}]}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"A", "[", "1", "]"}], ".", 
       RowBox[{"B", "[", "0", "]"}], ".", 
       RowBox[{"u", "[", "0", "]"}]}], "]"}]}], ")"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"B", "[", "1", "]"}], ".", 
   RowBox[{"u", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"u", "[", "1", "]"}], "]"}], ".", 
   RowBox[{"Transpose", "[", 
    RowBox[{"S", "[", "1", "]"}], "]"}], ".", 
   RowBox[{"A", "[", "0", "]"}], ".", 
   RowBox[{"x", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"u", "[", "1", "]"}], "]"}], ".", 
   RowBox[{"Transpose", "[", 
    RowBox[{"S", "[", "1", "]"}], "]"}], ".", 
   RowBox[{"B", "[", "0", "]"}], ".", 
   RowBox[{"u", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"a", "[", "1", "]"}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"A", "[", "1", "]"}], ".", 
       RowBox[{"a", "[", "0", "]"}]}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"B", "[", "1", "]"}], ".", 
       RowBox[{"u", "[", "1", "]"}]}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"A", "[", "1", "]"}], ".", 
       RowBox[{"A", "[", "0", "]"}], ".", 
       RowBox[{"x", "[", "0", "]"}]}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"A", "[", "1", "]"}], ".", 
       RowBox[{"B", "[", "0", "]"}], ".", 
       RowBox[{"u", "[", "0", "]"}]}], "]"}]}], ")"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"A", "[", "1", "]"}], ".", 
   RowBox[{"A", "[", "0", "]"}], ".", 
   RowBox[{"x", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"a", "[", "1", "]"}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"A", "[", "1", "]"}], ".", 
       RowBox[{"a", "[", "0", "]"}]}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"B", "[", "1", "]"}], ".", 
       RowBox[{"u", "[", "1", "]"}]}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"A", "[", "1", "]"}], ".", 
       RowBox[{"A", "[", "0", "]"}], ".", 
       RowBox[{"x", "[", "0", "]"}]}], "]"}], "+", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"A", "[", "1", "]"}], ".", 
       RowBox[{"B", "[", "0", "]"}], ".", 
       RowBox[{"u", "[", "0", "]"}]}], "]"}]}], ")"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"A", "[", "1", "]"}], ".", 
   RowBox[{"B", "[", "0", "]"}], ".", 
   RowBox[{"u", "[", "0", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.646039648859054*^9, 3.646039668910054*^9}, {
   3.6460398293820543`*^9, 3.646039884189054*^9}, {3.646039921593054*^9, 
   3.6460399415400543`*^9}, {3.646039982410054*^9, 3.646040026977054*^9}, 
   3.646040068740054*^9, 3.6460403264020834`*^9, 3.6460409414915857`*^9, 
   3.646041098458281*^9, 3.64604164520395*^9, 3.646043692766686*^9, 
   3.6460437814595547`*^9, 3.6460459435137377`*^9, {3.6460459823136177`*^9, 
   3.6460460045588417`*^9}, 3.64604967790714*^9, 3.6460498776241097`*^9, 
   3.6460501910514493`*^9, 3.6460502685401974`*^9, 3.6460505637467155`*^9, {
   3.646051003365673*^9, 3.646051013203656*^9}, 3.646120743682865*^9, 
   3.6463830223083725`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"a", "[", "0", "]"}], "]"}], ".", 
   RowBox[{"Q", "[", "1", "]"}], ".", 
   RowBox[{"a", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"a", "[", "0", "]"}], "]"}], ".", 
   RowBox[{"S", "[", "1", "]"}], ".", 
   RowBox[{"u", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"a", "[", "1", "]"}], "]"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"a", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"A", "[", "0", "]"}], ".", 
     RowBox[{"x", "[", "0", "]"}]}], "]"}], ".", 
   RowBox[{"Q", "[", "1", "]"}], ".", 
   RowBox[{"a", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"A", "[", "0", "]"}], ".", 
     RowBox[{"x", "[", "0", "]"}]}], "]"}], ".", 
   RowBox[{"S", "[", "1", "]"}], ".", 
   RowBox[{"u", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"A", "[", "1", "]"}], ".", 
     RowBox[{"a", "[", "0", "]"}]}], "]"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"a", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"B", "[", "0", "]"}], ".", 
     RowBox[{"u", "[", "0", "]"}]}], "]"}], ".", 
   RowBox[{"Q", "[", "1", "]"}], ".", 
   RowBox[{"a", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"B", "[", "0", "]"}], ".", 
     RowBox[{"u", "[", "0", "]"}]}], "]"}], ".", 
   RowBox[{"S", "[", "1", "]"}], ".", 
   RowBox[{"u", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"B", "[", "1", "]"}], ".", 
     RowBox[{"u", "[", "1", "]"}]}], "]"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"a", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"A", "[", "1", "]"}], ".", 
     RowBox[{"A", "[", "0", "]"}], ".", 
     RowBox[{"x", "[", "0", "]"}]}], "]"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"a", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"A", "[", "1", "]"}], ".", 
     RowBox[{"B", "[", "0", "]"}], ".", 
     RowBox[{"u", "[", "0", "]"}]}], "]"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"a", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"u", "[", "0", "]"}], "]"}], ".", 
   RowBox[{"R", "[", "0", "]"}], ".", 
   RowBox[{"u", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"u", "[", "0", "]"}], "]"}], ".", 
   RowBox[{"Transpose", "[", 
    RowBox[{"S", "[", "0", "]"}], "]"}], ".", 
   RowBox[{"x", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"u", "[", "1", "]"}], "]"}], ".", 
   RowBox[{"R", "[", "1", "]"}], ".", 
   RowBox[{"u", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"u", "[", "1", "]"}], "]"}], ".", 
   RowBox[{"Transpose", "[", 
    RowBox[{"S", "[", "1", "]"}], "]"}], ".", 
   RowBox[{"a", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"x", "[", "0", "]"}], "]"}], ".", 
   RowBox[{"Q", "[", "0", "]"}], ".", 
   RowBox[{"x", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"x", "[", "0", "]"}], "]"}], ".", 
   RowBox[{"S", "[", "0", "]"}], ".", 
   RowBox[{"u", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"a", "[", "0", "]"}], "]"}], ".", 
   RowBox[{"Q", "[", "1", "]"}], ".", 
   RowBox[{"A", "[", "0", "]"}], ".", 
   RowBox[{"x", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"a", "[", "0", "]"}], "]"}], ".", 
   RowBox[{"Q", "[", "1", "]"}], ".", 
   RowBox[{"B", "[", "0", "]"}], ".", 
   RowBox[{"u", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"a", "[", "1", "]"}], "]"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"A", "[", "1", "]"}], ".", 
   RowBox[{"a", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"a", "[", "1", "]"}], "]"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"B", "[", "1", "]"}], ".", 
   RowBox[{"u", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"A", "[", "0", "]"}], ".", 
     RowBox[{"x", "[", "0", "]"}]}], "]"}], ".", 
   RowBox[{"Q", "[", "1", "]"}], ".", 
   RowBox[{"A", "[", "0", "]"}], ".", 
   RowBox[{"x", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"A", "[", "0", "]"}], ".", 
     RowBox[{"x", "[", "0", "]"}]}], "]"}], ".", 
   RowBox[{"Q", "[", "1", "]"}], ".", 
   RowBox[{"B", "[", "0", "]"}], ".", 
   RowBox[{"u", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"A", "[", "1", "]"}], ".", 
     RowBox[{"a", "[", "0", "]"}]}], "]"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"A", "[", "1", "]"}], ".", 
   RowBox[{"a", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"A", "[", "1", "]"}], ".", 
     RowBox[{"a", "[", "0", "]"}]}], "]"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"B", "[", "1", "]"}], ".", 
   RowBox[{"u", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"B", "[", "0", "]"}], ".", 
     RowBox[{"u", "[", "0", "]"}]}], "]"}], ".", 
   RowBox[{"Q", "[", "1", "]"}], ".", 
   RowBox[{"A", "[", "0", "]"}], ".", 
   RowBox[{"x", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"B", "[", "0", "]"}], ".", 
     RowBox[{"u", "[", "0", "]"}]}], "]"}], ".", 
   RowBox[{"Q", "[", "1", "]"}], ".", 
   RowBox[{"B", "[", "0", "]"}], ".", 
   RowBox[{"u", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"B", "[", "1", "]"}], ".", 
     RowBox[{"u", "[", "1", "]"}]}], "]"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"A", "[", "1", "]"}], ".", 
   RowBox[{"a", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"B", "[", "1", "]"}], ".", 
     RowBox[{"u", "[", "1", "]"}]}], "]"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"B", "[", "1", "]"}], ".", 
   RowBox[{"u", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"A", "[", "1", "]"}], ".", 
     RowBox[{"A", "[", "0", "]"}], ".", 
     RowBox[{"x", "[", "0", "]"}]}], "]"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"A", "[", "1", "]"}], ".", 
   RowBox[{"a", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"A", "[", "1", "]"}], ".", 
     RowBox[{"A", "[", "0", "]"}], ".", 
     RowBox[{"x", "[", "0", "]"}]}], "]"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"B", "[", "1", "]"}], ".", 
   RowBox[{"u", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"A", "[", "1", "]"}], ".", 
     RowBox[{"B", "[", "0", "]"}], ".", 
     RowBox[{"u", "[", "0", "]"}]}], "]"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"A", "[", "1", "]"}], ".", 
   RowBox[{"a", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"A", "[", "1", "]"}], ".", 
     RowBox[{"B", "[", "0", "]"}], ".", 
     RowBox[{"u", "[", "0", "]"}]}], "]"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"B", "[", "1", "]"}], ".", 
   RowBox[{"u", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"u", "[", "1", "]"}], "]"}], ".", 
   RowBox[{"Transpose", "[", 
    RowBox[{"S", "[", "1", "]"}], "]"}], ".", 
   RowBox[{"A", "[", "0", "]"}], ".", 
   RowBox[{"x", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"u", "[", "1", "]"}], "]"}], ".", 
   RowBox[{"Transpose", "[", 
    RowBox[{"S", "[", "1", "]"}], "]"}], ".", 
   RowBox[{"B", "[", "0", "]"}], ".", 
   RowBox[{"u", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"a", "[", "1", "]"}], "]"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"A", "[", "1", "]"}], ".", 
   RowBox[{"A", "[", "0", "]"}], ".", 
   RowBox[{"x", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"a", "[", "1", "]"}], "]"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"A", "[", "1", "]"}], ".", 
   RowBox[{"B", "[", "0", "]"}], ".", 
   RowBox[{"u", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"A", "[", "1", "]"}], ".", 
     RowBox[{"a", "[", "0", "]"}]}], "]"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"A", "[", "1", "]"}], ".", 
   RowBox[{"A", "[", "0", "]"}], ".", 
   RowBox[{"x", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"A", "[", "1", "]"}], ".", 
     RowBox[{"a", "[", "0", "]"}]}], "]"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"A", "[", "1", "]"}], ".", 
   RowBox[{"B", "[", "0", "]"}], ".", 
   RowBox[{"u", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"B", "[", "1", "]"}], ".", 
     RowBox[{"u", "[", "1", "]"}]}], "]"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"A", "[", "1", "]"}], ".", 
   RowBox[{"A", "[", "0", "]"}], ".", 
   RowBox[{"x", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"B", "[", "1", "]"}], ".", 
     RowBox[{"u", "[", "1", "]"}]}], "]"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"A", "[", "1", "]"}], ".", 
   RowBox[{"B", "[", "0", "]"}], ".", 
   RowBox[{"u", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"A", "[", "1", "]"}], ".", 
     RowBox[{"A", "[", "0", "]"}], ".", 
     RowBox[{"x", "[", "0", "]"}]}], "]"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"A", "[", "1", "]"}], ".", 
   RowBox[{"A", "[", "0", "]"}], ".", 
   RowBox[{"x", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"A", "[", "1", "]"}], ".", 
     RowBox[{"A", "[", "0", "]"}], ".", 
     RowBox[{"x", "[", "0", "]"}]}], "]"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"A", "[", "1", "]"}], ".", 
   RowBox[{"B", "[", "0", "]"}], ".", 
   RowBox[{"u", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"A", "[", "1", "]"}], ".", 
     RowBox[{"B", "[", "0", "]"}], ".", 
     RowBox[{"u", "[", "0", "]"}]}], "]"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"A", "[", "1", "]"}], ".", 
   RowBox[{"A", "[", "0", "]"}], ".", 
   RowBox[{"x", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"A", "[", "1", "]"}], ".", 
     RowBox[{"B", "[", "0", "]"}], ".", 
     RowBox[{"u", "[", "0", "]"}]}], "]"}], ".", 
   RowBox[{"Q", "[", "2", "]"}], ".", 
   RowBox[{"A", "[", "1", "]"}], ".", 
   RowBox[{"B", "[", "0", "]"}], ".", 
   RowBox[{"u", "[", "0", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.646039648859054*^9, 3.646039668910054*^9}, {
   3.6460398293820543`*^9, 3.646039884189054*^9}, {3.646039921593054*^9, 
   3.6460399415400543`*^9}, {3.646039982410054*^9, 3.646040026977054*^9}, 
   3.646040068740054*^9, 3.6460403264020834`*^9, 3.6460409414915857`*^9, 
   3.646041098458281*^9, 3.64604164520395*^9, 3.646043692766686*^9, 
   3.6460437814595547`*^9, 3.6460459435137377`*^9, {3.6460459823136177`*^9, 
   3.6460460045588417`*^9}, 3.64604967790714*^9, 3.6460498776241097`*^9, 
   3.6460501910514493`*^9, 3.6460502685401974`*^9, 3.6460505637467155`*^9, {
   3.646051003365673*^9, 3.646051013203656*^9}, 3.646120743682865*^9, 
   3.6463830223083725`*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    TemplateBox[{RowBox[{"a", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"A", "(", "1", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "2", ")"}], ".", 
    RowBox[{"B", "(", "1", ")"}], ".", 
    RowBox[{"u", "(", "1", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"a", "(", "1", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "2", ")"}], ".", 
    RowBox[{"A", "(", "1", ")"}], ".", 
    RowBox[{"B", "(", "0", ")"}], ".", 
    RowBox[{"u", "(", "0", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"u", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"B", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"A", "(", "1", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "2", ")"}], ".", 
    RowBox[{"a", "(", "1", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"u", "(", "1", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"B", "(", "1", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "2", ")"}], ".", 
    RowBox[{"A", "(", "1", ")"}], ".", 
    RowBox[{"a", "(", "0", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"a", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"A", "(", "1", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "2", ")"}], ".", 
    RowBox[{"A", "(", "1", ")"}], ".", 
    RowBox[{"B", "(", "0", ")"}], ".", 
    RowBox[{"u", "(", "0", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"u", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"B", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"A", "(", "1", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "2", ")"}], ".", 
    RowBox[{"A", "(", "1", ")"}], ".", 
    RowBox[{"a", "(", "0", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"a", "(", "0", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "1", ")"}], ".", 
    RowBox[{"A", "(", "0", ")"}], ".", 
    RowBox[{"x", "(", "0", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"x", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"A", "(", "0", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "1", ")"}], ".", 
    RowBox[{"a", "(", "0", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"a", "(", "1", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "2", ")"}], ".", 
    RowBox[{"A", "(", "1", ")"}], ".", 
    RowBox[{"A", "(", "0", ")"}], ".", 
    RowBox[{"x", "(", "0", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"x", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"A", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"A", "(", "1", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "2", ")"}], ".", 
    RowBox[{"a", "(", "1", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"a", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"A", "(", "1", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "2", ")"}], ".", 
    RowBox[{"A", "(", "1", ")"}], ".", 
    RowBox[{"A", "(", "0", ")"}], ".", 
    RowBox[{"x", "(", "0", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"x", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"A", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"A", "(", "1", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "2", ")"}], ".", 
    RowBox[{"A", "(", "1", ")"}], ".", 
    RowBox[{"a", "(", "0", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"a", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"A", "(", "1", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "2", ")"}], ".", 
    RowBox[{"a", "(", "1", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"a", "(", "1", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "2", ")"}], ".", 
    RowBox[{"A", "(", "1", ")"}], ".", 
    RowBox[{"a", "(", "0", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"a", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"A", "(", "1", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "2", ")"}], ".", 
    RowBox[{"A", "(", "1", ")"}], ".", 
    RowBox[{"a", "(", "0", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"a", "(", "0", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "1", ")"}], ".", 
    RowBox[{"B", "(", "0", ")"}], ".", 
    RowBox[{"u", "(", "0", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"a", "(", "1", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "2", ")"}], ".", 
    RowBox[{"B", "(", "1", ")"}], ".", 
    RowBox[{"u", "(", "1", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"u", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"B", "(", "0", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "1", ")"}], ".", 
    RowBox[{"a", "(", "0", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"u", "(", "1", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"B", "(", "1", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "2", ")"}], ".", 
    RowBox[{"a", "(", "1", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"a", "(", "0", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "1", ")"}], ".", 
    RowBox[{"a", "(", "0", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"a", "(", "1", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "2", ")"}], ".", 
    RowBox[{"a", "(", "1", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"a", "(", "0", ")"}]},
     "Transpose"], ".", 
    RowBox[{"S", "(", "1", ")"}], ".", 
    RowBox[{"u", "(", "1", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"u", "(", "1", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"S", "(", "1", ")"}]},
     "Transpose"], ".", 
    RowBox[{"a", "(", "0", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"u", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"B", "(", "0", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "1", ")"}], ".", 
    RowBox[{"A", "(", "0", ")"}], ".", 
    RowBox[{"x", "(", "0", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"x", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"A", "(", "0", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "1", ")"}], ".", 
    RowBox[{"B", "(", "0", ")"}], ".", 
    RowBox[{"u", "(", "0", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"u", "(", "1", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"B", "(", "1", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "2", ")"}], ".", 
    RowBox[{"A", "(", "1", ")"}], ".", 
    RowBox[{"A", "(", "0", ")"}], ".", 
    RowBox[{"x", "(", "0", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"x", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"A", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"A", "(", "1", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "2", ")"}], ".", 
    RowBox[{"B", "(", "1", ")"}], ".", 
    RowBox[{"u", "(", "1", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"u", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"B", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"A", "(", "1", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "2", ")"}], ".", 
    RowBox[{"A", "(", "1", ")"}], ".", 
    RowBox[{"A", "(", "0", ")"}], ".", 
    RowBox[{"x", "(", "0", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"x", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"A", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"A", "(", "1", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "2", ")"}], ".", 
    RowBox[{"A", "(", "1", ")"}], ".", 
    RowBox[{"B", "(", "0", ")"}], ".", 
    RowBox[{"u", "(", "0", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"u", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"B", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"A", "(", "1", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "2", ")"}], ".", 
    RowBox[{"B", "(", "1", ")"}], ".", 
    RowBox[{"u", "(", "1", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"u", "(", "1", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"B", "(", "1", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "2", ")"}], ".", 
    RowBox[{"A", "(", "1", ")"}], ".", 
    RowBox[{"B", "(", "0", ")"}], ".", 
    RowBox[{"u", "(", "0", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"u", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"B", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"A", "(", "1", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "2", ")"}], ".", 
    RowBox[{"A", "(", "1", ")"}], ".", 
    RowBox[{"B", "(", "0", ")"}], ".", 
    RowBox[{"u", "(", "0", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"x", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"A", "(", "0", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "1", ")"}], ".", 
    RowBox[{"A", "(", "0", ")"}], ".", 
    RowBox[{"x", "(", "0", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"x", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"A", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"A", "(", "1", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "2", ")"}], ".", 
    RowBox[{"A", "(", "1", ")"}], ".", 
    RowBox[{"A", "(", "0", ")"}], ".", 
    RowBox[{"x", "(", "0", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"u", "(", "1", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"S", "(", "1", ")"}]},
     "Transpose"], ".", 
    RowBox[{"A", "(", "0", ")"}], ".", 
    RowBox[{"x", "(", "0", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"x", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"A", "(", "0", ")"}]},
     "Transpose"], ".", 
    RowBox[{"S", "(", "1", ")"}], ".", 
    RowBox[{"u", "(", "1", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"u", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"B", "(", "0", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "1", ")"}], ".", 
    RowBox[{"B", "(", "0", ")"}], ".", 
    RowBox[{"u", "(", "0", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"u", "(", "1", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"B", "(", "1", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "2", ")"}], ".", 
    RowBox[{"B", "(", "1", ")"}], ".", 
    RowBox[{"u", "(", "1", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"u", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"B", "(", "0", ")"}]},
     "Transpose"], ".", 
    RowBox[{"S", "(", "1", ")"}], ".", 
    RowBox[{"u", "(", "1", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"u", "(", "1", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"S", "(", "1", ")"}]},
     "Transpose"], ".", 
    RowBox[{"B", "(", "0", ")"}], ".", 
    RowBox[{"u", "(", "0", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"x", "(", "0", ")"}]},
     "Transpose"], ".", 
    RowBox[{"Q", "(", "0", ")"}], ".", 
    RowBox[{"x", "(", "0", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"u", "(", "0", ")"}]},
     "Transpose"], ".", 
    RowBox[{"R", "(", "0", ")"}], ".", 
    RowBox[{"u", "(", "0", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"u", "(", "1", ")"}]},
     "Transpose"], ".", 
    RowBox[{"R", "(", "1", ")"}], ".", 
    RowBox[{"u", "(", "1", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"u", "(", "0", ")"}]},
     "Transpose"], ".", 
    TemplateBox[{RowBox[{"S", "(", "0", ")"}]},
     "Transpose"], ".", 
    RowBox[{"x", "(", "0", ")"}]}], "+", 
   RowBox[{
    TemplateBox[{RowBox[{"x", "(", "0", ")"}]},
     "Transpose"], ".", 
    RowBox[{"S", "(", "0", ")"}], ".", 
    RowBox[{"u", "(", "0", ")"}]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.646039648859054*^9, 3.646039668910054*^9}, {
   3.6460398293820543`*^9, 3.646039884189054*^9}, {3.646039921593054*^9, 
   3.6460399415400543`*^9}, {3.646039982410054*^9, 3.646040026977054*^9}, 
   3.646040068740054*^9, 3.6460403264020834`*^9, 3.6460409414915857`*^9, 
   3.646041098458281*^9, 3.64604164520395*^9, 3.646043692766686*^9, 
   3.6460437814595547`*^9, 3.6460459435137377`*^9, {3.6460459823136177`*^9, 
   3.6460460045588417`*^9}, 3.64604967790714*^9, 3.6460498776241097`*^9, 
   3.6460501910514493`*^9, 3.6460502685401974`*^9, 3.6460505637467155`*^9, {
   3.646051003365673*^9, 3.646051013203656*^9}, 3.646120743682865*^9, 
   3.6463830223083725`*^9, 3.646383057238759*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Remove", "[", "extractQ", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"extractQ", "[", 
    RowBox[{"_", ",", "a_", ",", "b_"}], "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"extractQ", "[", 
   RowBox[{
    RowBox[{"Dot", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", "a_", "]"}], ",", "Q__", ",", "b_"}], "]"}], 
    ",", "a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{"Dot", "[", "Q", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"extractQ", "[", 
  RowBox[{
   RowBox[{"J", "[", 
    RowBox[{"[", 
     RowBox[{"-", "2"}], "]"}], "]"}], ",", 
   RowBox[{"x", "[", "0", "]"}], ",", 
   RowBox[{"x", "[", "0", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"extractQ", "[", 
  RowBox[{
   RowBox[{"J", "[", 
    RowBox[{"[", 
     RowBox[{"-", "1"}], "]"}], "]"}], ",", 
   RowBox[{"x", "[", "0", "]"}], ",", 
   RowBox[{"x", "[", "0", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"extractQ", "[", 
  RowBox[{
   RowBox[{"J", "[", 
    RowBox[{"[", 
     RowBox[{"-", "1"}], "]"}], "]"}], ",", 
   RowBox[{"x", "[", "0", "]"}], ",", 
   RowBox[{"u", "[", "0", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.646048481017463*^9, 3.6460486792512846`*^9}, {
   3.646048815744932*^9, 3.6460488521885767`*^9}, 3.646048889518309*^9, 
   3.6460510673460703`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transpose", "[", 
   RowBox[{"A", "[", "0", "]"}], "]"}], ".", 
  RowBox[{"Transpose", "[", 
   RowBox[{"A", "[", "1", "]"}], "]"}], ".", 
  RowBox[{"Q", "[", "2", "]"}], ".", 
  RowBox[{"A", "[", "1", "]"}], ".", 
  RowBox[{"A", "[", "0", "]"}]}]], "Output",
 CellChangeTimes->{{3.6460484928476458`*^9, 3.6460485184752083`*^9}, {
   3.6460486072960896`*^9, 3.646048679616321*^9}, {3.646048825799938*^9, 
   3.646048852773635*^9}, 3.64604888982434*^9, 3.646050236052949*^9, {
   3.6460510416164975`*^9, 3.6460510684611816`*^9}, 3.646120743727865*^9, 
   3.6463830223395767`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.6460484928476458`*^9, 3.6460485184752083`*^9}, {
   3.6460486072960896`*^9, 3.646048679616321*^9}, {3.646048825799938*^9, 
   3.646048852773635*^9}, 3.64604888982434*^9, 3.646050236052949*^9, {
   3.6460510416164975`*^9, 3.6460510684611816`*^9}, 3.646120743727865*^9, 
   3.6463830223395767`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transpose", "[", 
   RowBox[{"A", "[", "0", "]"}], "]"}], ".", 
  RowBox[{"Transpose", "[", 
   RowBox[{"A", "[", "1", "]"}], "]"}], ".", 
  RowBox[{"Q", "[", "2", "]"}], ".", 
  RowBox[{"A", "[", "1", "]"}], ".", 
  RowBox[{"B", "[", "0", "]"}]}]], "Output",
 CellChangeTimes->{{3.6460484928476458`*^9, 3.6460485184752083`*^9}, {
   3.6460486072960896`*^9, 3.646048679616321*^9}, {3.646048825799938*^9, 
   3.646048852773635*^9}, 3.64604888982434*^9, 3.646050236052949*^9, {
   3.6460510416164975`*^9, 3.6460510684611816`*^9}, 3.646120743727865*^9, 
   3.6463830223395767`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"w", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"x", "[", "0", "]"}], ",", 
    RowBox[{"u", "[", "0", "]"}], ",", 
    RowBox[{"u", "[", "1", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"extractQ", "[", 
        RowBox[{"#", ",", 
         RowBox[{"w", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
         ",", 
         RowBox[{
         "w", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], "]"}],
        "&"}], ",", "J"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "//", 
  "TraditionalForm"}]}], "Input",
 CellChangeTimes->{{3.6460487040347624`*^9, 3.646048713818741*^9}, {
  3.646048764572816*^9, 3.64604880022338*^9}, {3.6460489094913063`*^9, 
  3.6460489361339703`*^9}, {3.6460490443947954`*^9, 3.6460491534146957`*^9}, {
  3.6460494412824802`*^9, 3.6460494613804893`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"x", "[", "0", "]"}], ",", 
   RowBox[{"u", "[", "0", "]"}], ",", 
   RowBox[{"u", "[", "1", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6460494554879007`*^9, 3.6460494617155232`*^9}, 
   3.646051117002035*^9, 3.646120743755865*^9, 3.6463830223707805`*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        TemplateBox[{RowBox[{"A", "(", "0", ")"}]},
         "Transpose"], ".", 
        RowBox[{"Q", "(", "1", ")"}], ".", 
        RowBox[{"A", "(", "0", ")"}]}], "+", 
       RowBox[{
        TemplateBox[{RowBox[{"A", "(", "0", ")"}]},
         "Transpose"], ".", 
        TemplateBox[{RowBox[{"A", "(", "1", ")"}]},
         "Transpose"], ".", 
        RowBox[{"Q", "(", "2", ")"}], ".", 
        RowBox[{"A", "(", "1", ")"}], ".", 
        RowBox[{"A", "(", "0", ")"}]}], "+", 
       RowBox[{"Q", "(", "0", ")"}]}], 
      RowBox[{
       RowBox[{
        TemplateBox[{RowBox[{"A", "(", "0", ")"}]},
         "Transpose"], ".", 
        RowBox[{"Q", "(", "1", ")"}], ".", 
        RowBox[{"B", "(", "0", ")"}]}], "+", 
       RowBox[{
        TemplateBox[{RowBox[{"A", "(", "0", ")"}]},
         "Transpose"], ".", 
        TemplateBox[{RowBox[{"A", "(", "1", ")"}]},
         "Transpose"], ".", 
        RowBox[{"Q", "(", "2", ")"}], ".", 
        RowBox[{"A", "(", "1", ")"}], ".", 
        RowBox[{"B", "(", "0", ")"}]}], "+", 
       RowBox[{"S", "(", "0", ")"}]}], 
      RowBox[{
       RowBox[{
        TemplateBox[{RowBox[{"A", "(", "0", ")"}]},
         "Transpose"], ".", 
        RowBox[{"S", "(", "1", ")"}]}], "+", 
       RowBox[{
        TemplateBox[{RowBox[{"A", "(", "0", ")"}]},
         "Transpose"], ".", 
        TemplateBox[{RowBox[{"A", "(", "1", ")"}]},
         "Transpose"], ".", 
        RowBox[{"Q", "(", "2", ")"}], ".", 
        RowBox[{"B", "(", "1", ")"}]}]}]},
     {
      RowBox[{
       RowBox[{
        TemplateBox[{RowBox[{"B", "(", "0", ")"}]},
         "Transpose"], ".", 
        RowBox[{"Q", "(", "1", ")"}], ".", 
        RowBox[{"A", "(", "0", ")"}]}], "+", 
       RowBox[{
        TemplateBox[{RowBox[{"B", "(", "0", ")"}]},
         "Transpose"], ".", 
        TemplateBox[{RowBox[{"A", "(", "1", ")"}]},
         "Transpose"], ".", 
        RowBox[{"Q", "(", "2", ")"}], ".", 
        RowBox[{"A", "(", "1", ")"}], ".", 
        RowBox[{"A", "(", "0", ")"}]}], "+", 
       TemplateBox[{RowBox[{"S", "(", "0", ")"}]},
        "Transpose"]}], 
      RowBox[{
       RowBox[{
        TemplateBox[{RowBox[{"B", "(", "0", ")"}]},
         "Transpose"], ".", 
        RowBox[{"Q", "(", "1", ")"}], ".", 
        RowBox[{"B", "(", "0", ")"}]}], "+", 
       RowBox[{
        TemplateBox[{RowBox[{"B", "(", "0", ")"}]},
         "Transpose"], ".", 
        TemplateBox[{RowBox[{"A", "(", "1", ")"}]},
         "Transpose"], ".", 
        RowBox[{"Q", "(", "2", ")"}], ".", 
        RowBox[{"A", "(", "1", ")"}], ".", 
        RowBox[{"B", "(", "0", ")"}]}], "+", 
       RowBox[{"R", "(", "0", ")"}]}], 
      RowBox[{
       RowBox[{
        TemplateBox[{RowBox[{"B", "(", "0", ")"}]},
         "Transpose"], ".", 
        RowBox[{"S", "(", "1", ")"}]}], "+", 
       RowBox[{
        TemplateBox[{RowBox[{"B", "(", "0", ")"}]},
         "Transpose"], ".", 
        TemplateBox[{RowBox[{"A", "(", "1", ")"}]},
         "Transpose"], ".", 
        RowBox[{"Q", "(", "2", ")"}], ".", 
        RowBox[{"B", "(", "1", ")"}]}]}]},
     {
      RowBox[{
       RowBox[{
        TemplateBox[{RowBox[{"S", "(", "1", ")"}]},
         "Transpose"], ".", 
        RowBox[{"A", "(", "0", ")"}]}], "+", 
       RowBox[{
        TemplateBox[{RowBox[{"B", "(", "1", ")"}]},
         "Transpose"], ".", 
        RowBox[{"Q", "(", "2", ")"}], ".", 
        RowBox[{"A", "(", "1", ")"}], ".", 
        RowBox[{"A", "(", "0", ")"}]}]}], 
      RowBox[{
       RowBox[{
        TemplateBox[{RowBox[{"S", "(", "1", ")"}]},
         "Transpose"], ".", 
        RowBox[{"B", "(", "0", ")"}]}], "+", 
       RowBox[{
        TemplateBox[{RowBox[{"B", "(", "1", ")"}]},
         "Transpose"], ".", 
        RowBox[{"Q", "(", "2", ")"}], ".", 
        RowBox[{"A", "(", "1", ")"}], ".", 
        RowBox[{"B", "(", "0", ")"}]}]}], 
      RowBox[{
       RowBox[{
        TemplateBox[{RowBox[{"B", "(", "1", ")"}]},
         "Transpose"], ".", 
        RowBox[{"Q", "(", "2", ")"}], ".", 
        RowBox[{"B", "(", "1", ")"}]}], "+", 
       RowBox[{"R", "(", "1", ")"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.6460494554879007`*^9, 3.6460494617155232`*^9}, 
   3.646051117002035*^9, 3.646120743755865*^9, 3.646383022386382*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Remove", "[", "extractL", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"extractL", "[", 
    RowBox[{"_", ",", "a_", ",", "b_"}], "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"extractL", "[", 
   RowBox[{
    RowBox[{"Dot", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", "a_", "]"}], ",", "Q__", ",", "b_"}], "]"}], 
    ",", "a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{"Dot", "[", "Q", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"extractQ", "[", 
  RowBox[{
   RowBox[{"J", "[", 
    RowBox[{"[", 
     RowBox[{"-", "2"}], "]"}], "]"}], ",", 
   RowBox[{"x", "[", "0", "]"}], ",", 
   RowBox[{"x", "[", "0", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"extractQ", "[", 
  RowBox[{
   RowBox[{"J", "[", 
    RowBox[{"[", 
     RowBox[{"-", "1"}], "]"}], "]"}], ",", 
   RowBox[{"x", "[", "0", "]"}], ",", 
   RowBox[{"x", "[", "0", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"extractQ", "[", 
  RowBox[{
   RowBox[{"J", "[", 
    RowBox[{"[", 
     RowBox[{"-", "1"}], "]"}], "]"}], ",", 
   RowBox[{"x", "[", "0", "]"}], ",", 
   RowBox[{"u", "[", "0", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.646048481017463*^9, 3.6460486792512846`*^9}, {
   3.646048815744932*^9, 3.6460488521885767`*^9}, 3.646048889518309*^9, 
   3.6460510673460703`*^9, {3.646120758057865*^9, 3.646120764080865*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transpose", "[", 
   RowBox[{"A", "[", "0", "]"}], "]"}], ".", 
  RowBox[{"Transpose", "[", 
   RowBox[{"A", "[", "1", "]"}], "]"}], ".", 
  RowBox[{"Q", "[", "2", "]"}], ".", 
  RowBox[{"A", "[", "1", "]"}], ".", 
  RowBox[{"A", "[", "0", "]"}]}]], "Output",
 CellChangeTimes->{{3.6460484928476458`*^9, 3.6460485184752083`*^9}, {
   3.6460486072960896`*^9, 3.646048679616321*^9}, {3.646048825799938*^9, 
   3.646048852773635*^9}, 3.64604888982434*^9, 3.646050236052949*^9, {
   3.6460510416164975`*^9, 3.6460510684611816`*^9}, 3.6463830224175863`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.6460484928476458`*^9, 3.6460485184752083`*^9}, {
   3.6460486072960896`*^9, 3.646048679616321*^9}, {3.646048825799938*^9, 
   3.646048852773635*^9}, 3.64604888982434*^9, 3.646050236052949*^9, {
   3.6460510416164975`*^9, 3.6460510684611816`*^9}, 3.6463830224175863`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transpose", "[", 
   RowBox[{"A", "[", "0", "]"}], "]"}], ".", 
  RowBox[{"Transpose", "[", 
   RowBox[{"A", "[", "1", "]"}], "]"}], ".", 
  RowBox[{"Q", "[", "2", "]"}], ".", 
  RowBox[{"A", "[", "1", "]"}], ".", 
  RowBox[{"B", "[", "0", "]"}]}]], "Output",
 CellChangeTimes->{{3.6460484928476458`*^9, 3.6460485184752083`*^9}, {
   3.6460486072960896`*^9, 3.646048679616321*^9}, {3.646048825799938*^9, 
   3.646048852773635*^9}, 3.64604888982434*^9, 3.646050236052949*^9, {
   3.6460510416164975`*^9, 3.6460510684611816`*^9}, 3.6463830224175863`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Transpose", "[", 
   RowBox[{"a", "[", "0", "]"}], "]"}], ".", 
  RowBox[{"S", "[", "1", "]"}], ".", 
  RowBox[{"u", "[", "1", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transpose", "[", 
   RowBox[{"a", "[", "0", "]"}], "]"}], ".", 
  RowBox[{"S", "[", "1", "]"}], ".", 
  RowBox[{"u", "[", "1", "]"}]}]], "Output",
 CellChangeTimes->{3.6463830224487896`*^9}]
}, Open  ]]
},
WindowSize->{1600, 1178},
WindowMargins->{{Automatic, -1608}, {-48, Automatic}},
PrintingCopies->1,
PrintingPageRange->{32000, 32000},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Portrait",
"PaperSize"->{595.1999999999999, 841.68}},
Magnification:>1.5 Inherited,
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 1172, 26, 133, "Input"],
Cell[1754, 50, 522, 10, 44, "Output"],
Cell[2279, 62, 589, 13, 44, "Output"],
Cell[2871, 77, 512, 10, 44, "Output"],
Cell[3386, 89, 512, 10, 76, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3935, 104, 1823, 48, 104, "Input"],
Cell[5761, 154, 316, 9, 44, "Output"],
Cell[6080, 165, 576, 17, 44, "Output"],
Cell[6659, 184, 2390, 71, 101, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9086, 260, 1758, 48, 162, "Input"],
Cell[10847, 310, 4241, 119, 185, "Output"],
Cell[15091, 431, 7476, 213, 297, "Output"],
Cell[22570, 646, 8907, 250, 409, "Output"],
Cell[31480, 898, 11916, 344, 493, "Output"],
Cell[43399, 1244, 12708, 355, 290, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56144, 1604, 1335, 38, 191, "Input"],
Cell[57482, 1644, 613, 13, 44, "Output"],
Cell[58098, 1659, 347, 5, 44, "Output"],
Cell[58448, 1666, 613, 13, 44, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59098, 1684, 1041, 28, 75, "Input"],
Cell[60142, 1714, 312, 7, 44, "Output"],
Cell[60457, 1723, 4793, 133, 125, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65287, 1861, 1381, 38, 191, "Input"],
Cell[66671, 1901, 587, 12, 44, "Output"],
Cell[67261, 1915, 321, 4, 44, "Output"],
Cell[67585, 1921, 587, 12, 44, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[68209, 1938, 180, 5, 45, "Input"],
Cell[68392, 1945, 225, 6, 76, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
